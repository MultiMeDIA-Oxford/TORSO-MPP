function [P,d] = slicePlaneName( S )

  persistent HLA
  persistent VLA
  persistent LVOT
  persistent SA
  
  if isempty( HLA  ), HLA  = sph2cart( [0.7414651,-1.2644244;0.75233775,-1.2775466;0.75772434,-1.3014525;1.266416,-2.2699766;0.73132277,-1.3323956;0.68317246,-1.3488014;0.70769364,-1.3531986;0.71708196,-1.3572083;0.752645,-1.3580267;0.9555263,-1.8336099;0.65985805,-1.381499;0.97582334,-1.8387486;0.77170855,-1.3785195;0.6782205,-1.3954487;0.7711882,-1.3809794;0.8778967,-1.7777083;0.96244043,-1.7938355;0.82350457,-1.7553427;0.83749855,-1.7435509;0.8750739,-1.7441108;1.0198358,-1.7833562;0.84069794,-1.7084844;1.0007583,-1.720777;0.86992896,-1.6895914;1.0124899,-1.7145041;0.95002997,-1.6993644;0.7977759,-1.6775745;0.85413295,-1.6821752;0.87956667,-1.6766969;0.9638261,-1.6887363;0.888165,-1.6683557;0.6873057,-1.491968;0.7504582,-1.4901215;0.9514367,-1.668389;0.8093294,-1.6512347;0.7633101,-1.4947106;0.8358923,-1.649563;0.6708239,-1.5058905;0.8623465,-1.6471788;0.8907692,-1.6488533;1.0684493,-1.6723238;1.0696876,-1.6718853;1.085819,-1.6738305;0.67273456,-1.5130748;0.8932866,-1.641699;0.9206845,-1.6413182;0.7647748,-1.5199268;1.0076774,-1.6283002;1.1178762,-1.6390033;0.54075557,-1.5374159;1.2839403,-1.6543019;0.9468816,-1.6057001;1.0512097,-1.5978279;0.60420835,-1.5555143;1.0035015,-1.5941706;0.8643387,-1.5895544;0.839051,-1.587418;0.59809756,-1.5590397;0.58088416,-1.5593491;0.69181395,-1.5636911;0.6381772,-1.5680763;0.99249685,-1.5707964;1.1606405,-1.5664194;0.674641,-1.585017;0.745525,-1.5939397;0.8946673,-1.5429051;0.760341,-1.5988573;0.8994355,-1.5365788;0.8961279,-1.5355481;1.1156719,-1.519964;0.5425648,-1.6034343;0.70225006,-1.6128664;0.7176909,-1.621453;1.1088024,-1.4691432;0.966178,-1.4902835;0.9134466,-1.4892344;0.9087247,-1.4709134;1.0706964,-1.4262819;0.842628,-1.4588557;0.57056975,-1.6620823;1.0396833,-1.4141892;0.9007508,-1.4346102;0.7862229,-1.4483318;0.8621786,-1.4332459;0.93020666,-1.4148127;1.0051385,-1.3951634;0.78636014,-1.4359975;0.8076101,-1.4272443;0.89507735,-1.3956555;0.8866258,-1.3799267;0.782446,-1.3906596;0.9296485,-1.351738;0.83223027,-1.3732444;1.0459285,-1.2768437;1.0101144,-1.2472022;0.89608896,-1.2307485;0.9763939,-1.1823723;0.65822035,-1.892753;0.78172004,-1.1748103;0.8102659,-1.0812507] ); end
  if isempty( VLA  ), VLA  = sph2cart( [0.050688144,0.3527201;0.093441956,0.37917516;0.08649325,0.44625685;0.1194349,0.46796465;0.12271882,0.51967746;0.051116996,-2.5399194;0.10705676,0.6471499;0.23888539,0.619422;0.108287446,0.6562661;0.08336526,0.66079545;0.17435081,-2.4954004;0.07230286,0.66575766;0.035190538,0.6758757;0.1726888,0.65973645;0.06333252,-2.4639874;0.31401393,0.616387;0.14632036,0.67911685;0.18627508,0.6709758;0.099987164,-2.4254215;0.04865307,0.7246781;0.29561713,0.67865217;0.10064613,-2.4112306;0.041092355,-2.4062688;0.01840846,0.73742527;0.16794463,-2.4145951;0.15500787,-2.4085739;6.9969473e-3,-2.3922653;0.015003535,-2.3866754;0.2033975,-2.4040186;0.014067377,0.7664321;0.14098917,0.760391;0.09580255,0.76647484;0.03397426,-2.3708093;0.014256948,-2.3700604;0.045393914,-2.3695807;0.03506209,-2.3651302;0.35576412,0.7077485;0.14333296,-2.370695;0.10969088,0.7757686;0.10062191,1.1330338;0.14222902,-2.04636;0.26876366,-2.0697284;0.24281283,-2.0711713;0.08377577,1.0733775;9.448529e-3,-2.0955238;0.070314884,-2.1030912;0.28971776,-2.127533;0.11970961,1.0337721;0.026514936,1.0339396;0.25573015,-2.1423566;0.020680457,1.0188135;0.044403072,0.99984646;0.09319691,-2.1477778;0.1834614,-2.1610715;0.08380954,0.98765105;0.04286822,-2.1749098;0.10133647,-2.1809716;0.020407587,-2.1795628;0.1178283,0.9297847;0.01357901,0.930184;0.039944258,-2.2126846;0.05207932,-2.215532;0.01444704,-2.2242486;9.629343e-3,0.9173585;0.027132286,-2.225535;0.05405579,-2.2283652;0.124881156,-2.2338815;0.046013597,-2.234176;0.2173754,0.88786584;6.790293e-3,-2.2391524;0.029020209,0.8937669;7.4186157e-3,-2.249322;0.060834836,0.8882795;0.023349006,-2.2674174;8.490448e-3,-2.2758064;0.08185172,0.8616018;0.07466562,-2.2822595;9.810229e-3,-2.281625;0.16119596,-2.296535;0.1258982,0.84935874;0.020060549,0.8553882;0.012178244,0.8546253;0.14174679,-2.3030446;0.023878062,0.8459972;0.08474301,0.8409478;0.072255366,0.8389627;0.14458327,-2.3146434;0.2739375,-2.3410456;0.013543525,-2.3068113;0.076059654,0.8278349;1.0256501e-4,0.8301024;0.10757053,0.82140136;7.5975293e-3,0.82380605;0.15922008,-2.3337092;0.04528326,-2.3239229;0.2234021,0.7923795;0.062006447,-2.3279626;0.18030539,0.78773093;0.12589864,-2.3546793;0.034414873,0.79190445] ); end
  if isempty( LVOT ), LVOT = sph2cart( [0.5067367,-0.085288696;0.60195833,0.061819628;0.6079484,6.1362805e-3;0.5973387,0.123283766;0.5836523,-0.30893433;0.6720127,2.0999748e-3;0.63041776,0.29494223;0.6959908,0.010618086;0.70231247,0.040193897;0.7077507,-5.722248e-4;0.67627776,0.2652455;0.68858093,0.24004467;0.7304433,0.15353125;0.73271585,-0.14102381;0.73146343,-0.15438162;0.741377,-0.08356575;0.6965292,0.2984542;0.74259496,0.12198545;0.60234934,0.47953525;0.7011721,0.30820942;0.72504586,0.24131086;0.7538645,0.13090162;0.7649046,-0.060586683;0.7433672,0.21174157;0.64935344,0.45092353;0.7398021,-0.26732785;0.7132774,0.35323346;0.7186858,0.34582222;0.78179747,-0.07030929;0.6761298,0.4625355;0.7437672,0.3617969;0.738724,0.39229172;0.65467095,0.57030594;0.57366323,0.6573609;0.6208792,0.61640805;0.63934875,0.6542562;0.68172526,0.61925805;0.6531249,0.65243214;0.5897973,0.72693837;1.2647543,-0.42568314;1.0265472,0.94321287;1.2305934,-0.06846927;1.0524079,0.6361156;1.0762807,-0.30678782;0.772753,0.8553472;1.0532625,-0.30512315;1.0585891,0.2432509;0.68619025,0.8237275;1.01298,0.07262334;0.8705358,0.6026721;0.9372262,0.39703363;0.9761635,0.05965886;0.7759871,0.66772735;0.86037016,0.53214514;0.93882895,0.3091351;0.92950684,-0.3348108;0.88704926,0.4593501;0.86515725,0.49715003;0.93005425,0.2917357;0.86198974,0.48994392;0.89782757,0.34594107;0.798682,0.5563512;0.8278396,0.49129725;0.8769597,0.35343423;0.8829148,-0.29911745;0.7663246,0.54162765;0.89847994,0.12724398;0.8003163,0.47804838;0.87208694,0.26129866;0.8919575,0.12670867;0.8181637,0.42328495;0.89709926,-1.110223e-16;0.83541733,0.3573264;0.76694065,0.5058259;0.8629439,-0.2446836;0.8135684,0.39772666;0.7417415,0.52895254;0.8754507,0.07412028;0.8471951,0.22780448;0.80220205,0.37441608;0.8629521,0.08242167;0.7680601,0.4390576;0.82595766,0.2656063;0.8500044,0.12413477;0.83692145,-0.20297645;0.8342546,0.12754087;0.7726231,0.36710033;0.8172697,0.20634806;0.8306588,0.11653759;0.7630835,0.37873983;0.7671976,0.36770308;0.8261256,0.10173764;0.8009772,-0.24593501;0.7580413,0.35862255;0.81137186,0.13424662;0.79765284,-0.1582672;0.80251664,-0.08349437;0.7866451,0.11506764;0.7921887,-7.7315047e-3] ); end
  if isempty( SA   ), SA   = sph2cart( [0.08901179,2.6511552;0.20457095,2.6592777;0.3593061,2.682254;0.12762,2.5513616;0.3557401,2.6415958;0.5361949,2.8100975;0.33477,2.6023214;0.42908704,2.6633332;0.42908707,2.6633332;0.37651753,2.614379;0.27759743,2.5309603;0.25559622,2.5065713;0.5409054,2.7096217;0.4736752,2.622932;0.34163377,2.5261657;0.38296372,2.5462615;0.41290915,2.5556464;0.43538123,2.5642283;0.42301294,2.5449064;0.46513876,2.5705218;0.39142394,2.5191453;0.5872114,2.6814117;0.51265997,2.5963414;0.51265967,2.596341;0.35401538,2.4763503;0.4358497,2.5214705;0.5054286,2.570947;0.3623832,2.4701984;0.45345348,2.5058746;0.4534541,2.5058749;0.28808627,2.4204323;0.52961546,2.552825;0.529616,2.5528252;0.5350826,2.556482;0.42106825,2.4687562;0.505185,2.523927;0.42815337,2.4670842;0.574153,2.5752637;0.5778802,2.578638;0.4776027,2.4926314;0.5281355,2.530476;0.37872738,2.4348068;0.5891779,2.5741055;0.30583605,2.3960764;0.45213002,2.4625518;0.3473246,2.4104629;0.42076394,2.4418602;0.54460484,2.5249903;0.5439033,2.5205855;0.22833903,2.366496;0.3938056,2.4221687;0.4341449,2.4371915;0.5554025,2.518423;0.6603333,2.632452;0.45746988,2.4454675;0.5125661,2.4776845;0.5267707,2.4793193;0.567214,2.5092392;0.55734456,2.4907317;0.4559926,2.4119043;0.587328,2.4995427;0.6744166,2.5900388;0.46020016,2.3933163;0.43086305,2.372504;0.5358057,2.431427;0.32813978,2.3288248;0.3985254,2.3539627;0.59005105,2.4692354;0.6200163,2.4938238;0.6973357,2.5794635;0.6956904,2.5729642;0.5646652,2.4398415;0.5034235,2.395312;0.5993092,2.4580863;0.59218854,2.4458601;0.59218836,2.4458601;0.6164952,2.464597;0.5231345,2.3793304;0.5281908,2.3791537;0.4825131,2.3530424;0.48251286,2.353042;0.3811787,2.307764;0.5359416,2.3777642;0.62268525,2.4361813;0.5256718,2.365437;0.46441653,2.3248367;0.5470512,2.368052;0.35099038,2.2776299;0.3509906,2.2776299;0.72057176,2.5137575;0.5295172,2.3476675;0.6317952,2.40153;0.6453956,2.409611;0.73121446,2.4890208;0.3659787,2.255512;0.61015266,2.3522458;0.61015254,2.3522458;0.7119603,2.4164517;0.33913627,2.2127123;0.4310152,2.2401521;0.43101534,2.2401521;0.580026,2.2984083;0.7758866,2.4386485;0.5883622,2.2140071;0.86433196,2.443438;0.7022449,2.264639;0.7460196,2.2850428;0.76956415,2.2513642;0.6076176,2.1142137] ); end


  if     isa( S , 'I3D' )
    S = S.SpatialTransform(1:3,3);
  elseif isstruct( S )  &&  isfield( S , 'ImageOrientationPatient' );
    S = S.ImageOrientationPatient;
    S = cross( S(1:3) , S(4:6) );
  elseif isnumeric( S ) && numel( S ) == 6
    S = cross( S(1:3) , S(4:6) );
  elseif isnumeric( S ) && numel( S ) == 3
%     S = S;
  elseif isnumeric( S ) && isequal( size(S) , [3 3] )
    S = S(1:3,3);
  elseif isnumeric( S ) && isequal( size(S) , [4 4] )
    S = S(1:3,3);
  else
    S = getPlane( S );
    S = S(1:3,3);
  end
  
  S = double( S );
  S = S(:)/sqrt( S(:).' * S(:) );
  
  d = d2normal( S , [0,0,1] ); if d < 1e-2, P = 'AX';   return; end
  d = d2normal( S , [0,1,0] ); if d < 1e-2, P = 'COR';  return; end
  d = d2normal( S , [1,0,0] ); if d < 1e-2, P = 'SAG';  return; end
  
  dHLA  = d2normal( S , HLA  );
  dVLA  = d2normal( S , VLA  );
  dLVOT = d2normal( S , LVOT );
  dSA   = d2normal( S , SA   );
  
  [d,id] = min( [ dHLA , dVLA , dLVOT , dSA ] );
  switch id
    case 1, P = 'HLAx';
    case 2, P = 'VLAx';
    case 3, P = 'LVOT';
    case 4, P = 'SAx';
  end

end
function XYZ = sph2cart( EA )
  XYZ = [ cos( EA(:,1) ) .* cos( EA(:,2) ) , cos( EA(:,1) ) .* sin( EA(:,2) ) , sin( EA(:,1) ) ];
end
function d = d2normal( S , N )
  d = min( ipd( S(:).' , N , 'normal' ) );
end